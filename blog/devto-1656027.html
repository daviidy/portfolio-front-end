<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="https://david-yao.com/_next/static/media/a34f9d1faa5f3315-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="stylesheet" href="https://david-yao.com/_next/static/css/5a598a53a1b8c772.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="https://david-yao.com/_next/static/chunks/webpack-c97c4cd6be511ece.js"/><script src="https://david-yao.com/_next/static/chunks/fd9d1056-bb11881ef41582aa.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/23-d4169bb1b2b13904.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/main-app-21646b6be18e1e6c.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/231-2d095471957ff3d5.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/633-2667c71f837e2c91.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/685-38d3d3a09bf3d7e5.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/392-a90341f24030e785.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/app/layout-a6b5bc5d75b10efa.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/173-06ea4b2e1871cc35.js" async=""></script><script src="https://david-yao.com/_next/static/chunks/app/blog/%5Bslug%5D/page-180ef92bcd4a6ad4.js" async=""></script><title>How to implement Token-Based Authentication and Authorization in Rails | Nda David Yao</title><meta name="description" content="&quot;Technologies change, but the basics are the same&quot;. That&#x27;s what my mentor told me years ago when I..."/><meta name="robots" content="index, follow"/><meta name="googlebot" content="index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1"/><meta property="og:title" content="How to implement Token-Based Authentication and Authorization in Rails"/><meta property="og:description" content="&quot;Technologies change, but the basics are the same&quot;. That&#x27;s what my mentor told me years ago when I..."/><meta property="og:url" content="https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj"/><meta property="og:image" content="https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png"/><meta property="og:type" content="article"/><meta property="article:published_time" content="2023-11-30T06:16:47Z"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="How to implement Token-Based Authentication and Authorization in Rails"/><meta name="twitter:description" content="&quot;Technologies change, but the basics are the same&quot;. That&#x27;s what my mentor told me years ago when I..."/><meta name="twitter:image" content="https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png"/><link rel="shortcut icon" href="/dave.png"/><link rel="icon" href="/dave.png"/><link rel="apple-touch-icon" href="/dave.png"/><meta name="next-size-adjust"/><script src="https://david-yao.com/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="min-h-screen bg-background font-sans antialiased max-w-2xl mx-auto py-12 sm:py-24 px-6 __variable_18454d"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&false)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}else{c.add('light')}if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'light'}catch(e){}}()</script><section id="blog"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","headline":"How to implement Token-Based Authentication and Authorization in Rails","datePublished":"2023-11-30T06:16:47Z","dateModified":"2023-11-30T06:16:47Z","description":"\"Technologies change, but the basics are the same\". That's what my mentor told me years ago when I...","image":"https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png","url":"https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj","author":{"@type":"Person","name":"Nda David Yao"}}</script><h1 class="title font-medium text-2xl tracking-tighter max-w-[650px]">How to implement Token-Based Authentication and Authorization in Rails</h1><div class="flex justify-between items-center mt-2 mb-8 text-sm max-w-[650px]"><!--$--><p class="text-sm text-neutral-600 dark:text-neutral-400">November 30, 2023 (1y ago)</p><!--/$--><a target="_blank" rel="noopener noreferrer" class="text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-800 dark:hover:text-neutral-200" href="https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj">Read on Dev.to â†’</a></div><article class="prose dark:prose-invert max-w-none prose-pre:bg-neutral-100 dark:prose-pre:bg-neutral-900 prose-pre:border prose-pre:border-neutral-200 dark:prose-pre:border-neutral-800 prose-pre:rounded-lg prose-code:before:content-none prose-code:after:content-none prose-code:font-normal prose-code:bg-neutral-100 dark:prose-code:bg-neutral-900 prose-code:rounded prose-code:px-1 prose-code:py-0.5 prose-code:text-neutral-800 dark:prose-code:text-neutral-200 prose-a:text-blue-500 hover:prose-a:text-blue-400 prose-headings:font-medium prose-h2:text-xl prose-h2:tracking-tight prose-p:leading-7 prose-li:leading-7"><p>"Technologies change, but the basics are the same". That's what my mentor told me years ago when I asked him how I could be a great software engineer. And it's so true especially when it comes to securing an API with a token-based authentication. No matter the framework you use (Spring, Rails, Laravel, etc.), the principle is the same. So in this blog post, we will discuss how to implement it successfully in your Rails application.</p>
<h2>The project:</h2>
<p>We want to create a backend API for an app like <a href="https://www.hackerrank.com/">Hackerrank</a>.
Here is the Database Design and Entity-Relationship Diagram (ERD) for the API.</p>
<p>For the entities, we have:
- Users
- Challenges (Programming questions)
- Submissions (User solutions to challenges)
- Categories (Challenge categories)
- Comments (User comments on challenges)
- Ratings (User ratings for challenges)
- Test Cases (Input and expected output for challenges)</p>
<p><img src="https://dev-to-uploads.s3.amazonaws.com/uploads/articles/s00w7deqg0n3pgyia5vv.png" alt="Image description"></p>
<p>Here are some relationships from the diagram above:
- A User has many Submissions.
- A Challenge belongs to a Category.
- A Challenge has many Test Cases.
- Only admins can create, update, or delete challenges, submissions, categories, or test cases.</p>
<p>Now, let's focus on implementing the authentication and authorization for our API. I assume you already know how to install a rails application focused on an API implementation, how to generate controllers and models.
We will go with the basic MVC architecture provided by Rails.</p>
<h2>Install the necessary gems</h2>
<ul>
<li>Add this to your <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>Gemfile</span></span></code></span>:</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">gem </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'bcrypt'</span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"> # For hashing passwords</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">gem </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'jwt'</span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">   # For JWT authentication</span></span></code></pre></figure>
<p><span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>bcrypt</span></span></code></span> will be used for password-hashing.
<span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>jwt</span></span></code></span> will be used to successfully log the user in and handle authorization.</p>
<ul>
<li>Create a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>secret_key_generator</span></span></code></span> file in your <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>initializers</span></span></code></span> folder and paste this:</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># config/initializers/secret_key_generator.rb</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># Require the SecureRandom module</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">require</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'securerandom'</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># Generate a random secret key</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">secret_key </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> SecureRandom</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.hex(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">32</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">) </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># Adjust the size as needed (e.g., 64 characters for a 256-bit key)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># Set the secret key as an environment variable</span></span>
<span data-line=""><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">ENV</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'APP_SECRET_KEY'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> secret_key</span></span>
<span data-line=""> </span></code></pre></figure>
<p>Initializers are executed when the Rails application boots. In our case, this initializer generates a random secret key using SecureRandom and sets it as an environment variable (APP_SECRET_KEY). We will use it to decode JWT tokens.</p>
<h2>Create the models and migration files</h2>
<ul>
<li>User</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> User</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationRecord</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  enum </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">role:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">default:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> 0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">admin:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> 1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:name</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  validates_uniqueness_of </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:password</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">length:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">minimum:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> 6</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  has_secure_password</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> admin?</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    role </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">==</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'admin'</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> CreateUsers</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ActiveRecord::Migration</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">7.1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> change</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    create_table </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:users</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> do</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> |t|</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.string </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:name</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.string </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.string </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:password_digest</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.integer </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:role</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.timestamps</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<ul>
<li>Category</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> Category</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationRecord</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">allow_blank:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    has_many </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenge_categories</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    has_many </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenges</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">through:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :challenge_categories</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> CreateCategories</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ActiveRecord::Migration</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">7.1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> change</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    create_table </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:categories</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> do</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> |t|</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.string </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.text </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:null</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> => </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">true</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.timestamps</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<ul>
<li>Challenge</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> Challenge</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationRecord</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    validates </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">presence:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    has_many </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenge_categories</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    has_many </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:categories</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">through:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :challenge_categories</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> CreateChallenges</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ActiveRecord::Migration</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">7.1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> change</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    create_table </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenges</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> do</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> |t|</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.string </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.text </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.timestamps</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<p>And since there is a many-to-many relationship between Challenge and Category, let's add the pivot table:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> CreateChallengeCategories</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ActiveRecord::Migration</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">7.1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> change</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    create_table </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenge_categories</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> do</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> |t|</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.references </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">null:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> false</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">foreign_key:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.references </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">null:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> false</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">foreign_key:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> true</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      t.timestamps</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<h2>Add the routes</h2>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">resources </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:users</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">only:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:create</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  namespace </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:auth</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> do</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    post </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'/login'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">to:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'sessions#create'</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    delete </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'/logout'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">to:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'sessions#destroy'</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  resources </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenges</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  post </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'/admin'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">to:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'users#add_admin'</span></span></code></pre></figure>
<p>You may have guessed it, but you will need to create a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>controllers/auth</span></span></code></span> folder. I'll explain why in a few minutes.</p>
<h2>Authentication logic</h2>
<ul>
<li>Add this to your <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>users_controller</span></span></code></span> file:</li>
</ul>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> UsersController</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationController</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> create</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> User</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">new</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">(user_params)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @user.save</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Registration successful. Please log in.'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :created</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">errors:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @user.errors.full_messages }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> add_admin</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    email </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> params[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> email.blank?</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">errors:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Email parameter is required'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> User</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.find_by(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">email:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> email)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @user.nil?</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">errors:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'No user with that Email found'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :not_found</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      @user.update_column(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:role</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">1</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'User is now an admin'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :ok</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  private</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> user_params</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      params.require(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:user</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">).permit(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:name</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:password</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:password_confirmation</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<p>That controller is simply responsible for creating new users and admins.</p>
<p>Create a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>helpers/token_helper</span></span></code></span> file in your <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>app</span></span></code></span> folder and add this code:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># app/helpers/token_helper.rb</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">module</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> TokenHelper</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> decode_token</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">(token)</span></span>
<span data-line=""><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">    JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.decode(token, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">ENV</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'APP_SECRET_KEY'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">], </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">algorithm:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'HS256'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">0</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  rescue</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">::</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">DecodeError</span></span>
<span data-line=""><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">    nil</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<p>And include it in your <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>application_controller</span></span></code></span>:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">include</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> TokenHelper</span></span></code></pre></figure>
<p>Now let's create a <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>sessions_controller</span></span></code></span> in our <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>auth</span></span></code></span> folder and add this code:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># app/controllers/sessions_controller.rb</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> Auth::SessionsController</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationController</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> create</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> User</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.find_by(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">email:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> params[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:email</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">])</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">&#x26;&#x26;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> user.authenticate(params[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:password</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">])</span></span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # Set the expiration time (e.g., 1 hour from now)</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        expiration_time </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Time</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.now.to_i </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">+</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> (</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">3600</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> *</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> 3</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">) </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># 3600 seconds = 1 hour</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # Create the payload</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        payload </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span></span>
<span data-line=""><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">            user_id:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> user.id,</span></span>
<span data-line=""><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">            exp:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> expiration_time </span><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D"># This sets the expiration time</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        }</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        token </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.encode(payload, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">ENV</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'APP_SECRET_KEY'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">], </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'HS256'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Logged in successfully'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">token:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> token }</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">error:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Invalid credentials'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unauthorized</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> destroy</span></span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">    # Invalidate the JWT token by marking it as expired or revoking it.</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    token </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> extract_token_from_request</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> token</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">      begin</span></span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # Try to decode the token to check its validity</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        payload, _ </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.decode(token, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">ENV</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'APP_SECRET_KEY'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">], </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">true</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">algorithm:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'HS256'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # At this point, the token is considered valid</span></span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # Add expiration to the payload to mark the token as invalid</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        payload[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'exp'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">] </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Time</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.now.to_i</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        new_token </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.encode(payload, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">ENV</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'APP_SECRET_KEY'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">], </span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'HS256'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Logged out successfully'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">      rescue</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> JWT</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">::</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">DecodeError</span></span>
<span data-line=""><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D">        # JWT::DecodeError is raised when the token is not valid</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'You need to sign in or sign up before continuing'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unauthorized</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">      end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'No token found'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  private</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> extract_token_from_request</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    request.headers[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'Authorization'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]&#x26;.split&#x26;.last</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<p>What we did there basically is generate a new token when a user logs in and invalidate a token when a user logs out. Remember, the token is used to check if a user session is valid or not. If you don't know how JWT tokens work, check the documentation <a href="https://en.wikipedia.org/wiki/JSON_Web_Token">here</a>.</p>
<p>Now if you request <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>POST /users</span></span></code></span> and <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>POST /login</span></span></code></span> with the correct parameters using Postman, it should work.</p>
<h2>Add the Challenge and Category controllers:</h2>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ChallengesController</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationController</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:set_challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">only:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:destroy</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:authorize_user</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">except:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:index</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:authorize_admin</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">except:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:index</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> index</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        @challenges </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.all</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenges</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> show</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> create</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        @challenge </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">new</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">(challenge_params)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge.save</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :created</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge.errors, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> update</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge.update(challenge_params)</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @challenge.errors, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> destroy</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        @challenge.destroy</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">message:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Challenge was successfully deleted'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    private</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> set_challenge</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        @challenge </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.find(params[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:id</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">])</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> challenge_params</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        params.require(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:challenge</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">).permit(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">category_ids:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [])</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">class</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> CategoriesController</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> &#x3C;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> ApplicationController</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:set_category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">only:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:update</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:destroy</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:authorize_user</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">except:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:index</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">  before_action </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:authorize_admin</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">except:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:index</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:show</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> index</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @categories </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.all</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @categories</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> show</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> create</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @category </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">new</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">(category_params)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category.save</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :created</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category.errors, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> update</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category.update(category_params)</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">      render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> @category.errors, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unprocessable_entity</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> destroy</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @category.destroy</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    head </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:no_content</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  private</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> set_category</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    @category </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> Category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.find(params[</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:id</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">])</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> category_params</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">    params.require(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:category</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">).permit(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:title</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">:description</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">challenge_ids:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> [])</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">  end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">end</span></span>
<span data-line=""> </span></code></pre></figure>
<p>As you can see, both controllers check if the user session is valid before executing some controller actions (create, update, delete). They are doing so with authorize_user and authorize_admin.
Add those methods in your application_controller:</p>
<figure data-rehype-pretty-code-figure=""><pre style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff" tabindex="0" data-language="ruby" data-theme="github-dark github-light"><code data-language="ruby" data-theme="github-dark github-light" style="display: grid;"><span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> authorize_user</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        token </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> request.headers[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'Authorization'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">]&#x26;.split(</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">' '</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">)&#x26;.last</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">        payload </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> decode_token(token)</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> payload.nil?</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">error:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Unauthorized'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unauthorized</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        else</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            @current_user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">=</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> User</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">.find(payload[</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62">'user_id'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">])</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span>
<span data-line=""> </span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    def</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1"> authorize_admin</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        if</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> !</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">@current_user </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">||</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49"> !</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">@current_user.admin?</span></span>
<span data-line=""><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E">            render </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">json:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> { </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">error:</span><span style="--shiki-dark:#9ECBFF;--shiki-light:#032F62"> 'Unauthorized'</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E"> }, </span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5">status:</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5"> :unauthorized</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">        end</span></span>
<span data-line=""><span style="--shiki-dark:#F97583;--shiki-light:#D73A49">    end</span></span></code></pre></figure>
<p>Now, try to create a challenge without logging in and you should get an <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark github-light" style="--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff"><span data-line=""><span>Unauthorized</span></span></code></span> message. Log in, set the current user as admin, try again and it should work.</p>
<p>Et voila, let me know in the comments section if you found this article helpful.</p></article><div class="mt-16"><div class="flex items-center justify-between mb-8"><h2 class="text-xl font-medium tracking-tighter">Comments (<!-- -->3<!-- -->)</h2><a target="_blank" rel="noopener noreferrer" class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2" href="https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj#comments">Add Comment</a></div><div class="space-y-8"><div class="flex gap-4"><div class="flex-shrink-0"><img alt="CedricLapi" loading="lazy" width="40" height="40" decoding="async" data-nimg="1" class="rounded-full" style="color:transparent" src="https://media2.dev.to/dynamic/image/width=640,height=640,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F1120282%2F9ecbab3b-8cda-4acd-92fc-bf4eb86d4bbc.jpeg"/></div><div class="flex-1"><div class="flex items-center gap-2 mb-2"><span class="font-medium">CedricLapi</span><span class="text-sm text-neutral-600 dark:text-neutral-400">@<!-- -->cedriclapi</span><span class="text-sm text-neutral-600 dark:text-neutral-400">â€¢ <!-- -->November 30, 2023 (1y ago)</span></div><div class="prose dark:prose-invert"><p>Nice article, quite interesting!</p>

</div></div></div></div></div></section><div class="pointer-events-none fixed inset-x-0 bottom-0 z-30 mx-auto mb-4 flex origin-bottom h-full max-h-14"><div class="fixed bottom-0 inset-x-0 h-16 w-full bg-background to-transparent backdrop-blur-lg [-webkit-mask-image:linear-gradient(to_top,black,transparent)] dark:bg-background"></div><div class="w-max p-2 rounded-full border z-50 pointer-events-auto relative mx-auto flex min-h-full h-full items-center px-1 bg-background [box-shadow:0_0_0_1px_rgba(0,0,0,.03),0_2px_4px_rgba(0,0,0,.05),0_12px_24px_rgba(0,0,0,.05)] transform-gpu dark:[border:1px_solid_rgba(255,255,255,.1)] dark:[box-shadow:0_-20px_80px_-20px_#ffffff1f_inset]"><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home size-4"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg></a></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="/blog"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-notebook size-4"><path d="M2 6h4"></path><path d="M2 10h4"></path><path d="M2 14h4"></path><path d="M2 18h4"></path><rect width="16" height="20" x="4" y="2" rx="2"></rect><path d="M16 2v20"></path></svg></a></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="/ebook"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-book size-4"><path d="M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20"></path></svg></a></div><div data-orientation="vertical" role="none" class="shrink-0 bg-border w-[1px] h-full" mousex="[object Object]" magnification="60" distance="140"></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="https://github.com/daviidy"><svg viewBox="0 0 438.549 438.549" class="size-4"><path fill="currentColor" d="M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"></path></svg></a></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="https://www.linkedin.com/in/nda-yao/"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="size-4"><title>LinkedIn</title><path fill="currentColor" d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"></path></svg></a></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="https://x.com/davidyao_dev"><svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="size-4"><title>X</title><path fill="currentColor" d="M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z"></path></svg></a></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><a class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12" data-state="closed" href="https://www.youtube.com/@davidyao_dev"><svg width="32px" height="32px" viewBox="0 0 32 32" fill="currentColor" xmlns="http://www.w3.org/2000/svg" class="size-4"><title>youtube</title><path d="M29.41,9.26a3.5,3.5,0,0,0-2.47-2.47C24.76,6.2,16,6.2,16,6.2s-8.76,0-10.94.59A3.5,3.5,0,0,0,2.59,9.26,36.13,36.13,0,0,0,2,16a36.13,36.13,0,0,0,.59,6.74,3.5,3.5,0,0,0,2.47,2.47C7.24,25.8,16,25.8,16,25.8s8.76,0,10.94-.59a3.5,3.5,0,0,0,2.47-2.47A36.13,36.13,0,0,0,30,16,36.13,36.13,0,0,0,29.41,9.26ZM13.2,20.2V11.8L20.47,16Z"></path></svg></a></div><div data-orientation="vertical" role="none" class="shrink-0 bg-border w-[1px] h-full py-2" mousex="[object Object]" magnification="60" distance="140"></div><div class="flex aspect-square cursor-pointer items-center justify-center rounded-full" style="width:40px"><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9 rounded-full px-2" type="button"><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="h-[1.2rem] w-[1.2rem] text-neutral-800 dark:hidden dark:text-neutral-200"><path d="M7.5 0C7.77614 0 8 0.223858 8 0.5V2.5C8 2.77614 7.77614 3 7.5 3C7.22386 3 7 2.77614 7 2.5V0.5C7 0.223858 7.22386 0 7.5 0ZM2.1967 2.1967C2.39196 2.00144 2.70854 2.00144 2.90381 2.1967L4.31802 3.61091C4.51328 3.80617 4.51328 4.12276 4.31802 4.31802C4.12276 4.51328 3.80617 4.51328 3.61091 4.31802L2.1967 2.90381C2.00144 2.70854 2.00144 2.39196 2.1967 2.1967ZM0.5 7C0.223858 7 0 7.22386 0 7.5C0 7.77614 0.223858 8 0.5 8H2.5C2.77614 8 3 7.77614 3 7.5C3 7.22386 2.77614 7 2.5 7H0.5ZM2.1967 12.8033C2.00144 12.608 2.00144 12.2915 2.1967 12.0962L3.61091 10.682C3.80617 10.4867 4.12276 10.4867 4.31802 10.682C4.51328 10.8772 4.51328 11.1938 4.31802 11.3891L2.90381 12.8033C2.70854 12.9986 2.39196 12.9986 2.1967 12.8033ZM12.5 7C12.2239 7 12 7.22386 12 7.5C12 7.77614 12.2239 8 12.5 8H14.5C14.7761 8 15 7.77614 15 7.5C15 7.22386 14.7761 7 14.5 7H12.5ZM10.682 4.31802C10.4867 4.12276 10.4867 3.80617 10.682 3.61091L12.0962 2.1967C12.2915 2.00144 12.608 2.00144 12.8033 2.1967C12.9986 2.39196 12.9986 2.70854 12.8033 2.90381L11.3891 4.31802C11.1938 4.51328 10.8772 4.51328 10.682 4.31802ZM8 12.5C8 12.2239 7.77614 12 7.5 12C7.22386 12 7 12.2239 7 12.5V14.5C7 14.7761 7.22386 15 7.5 15C7.77614 15 8 14.7761 8 14.5V12.5ZM10.682 10.682C10.8772 10.4867 11.1938 10.4867 11.3891 10.682L12.8033 12.0962C12.9986 12.2915 12.9986 12.608 12.8033 12.8033C12.608 12.9986 12.2915 12.9986 12.0962 12.8033L10.682 11.3891C10.4867 11.1938 10.4867 10.8772 10.682 10.682ZM5.5 7.5C5.5 6.39543 6.39543 5.5 7.5 5.5C8.60457 5.5 9.5 6.39543 9.5 7.5C9.5 8.60457 8.60457 9.5 7.5 9.5C6.39543 9.5 5.5 8.60457 5.5 7.5ZM7.5 4.5C5.84315 4.5 4.5 5.84315 4.5 7.5C4.5 9.15685 5.84315 10.5 7.5 10.5C9.15685 10.5 10.5 9.15685 10.5 7.5C10.5 5.84315 9.15685 4.5 7.5 4.5Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg><svg width="15" height="15" viewBox="0 0 15 15" fill="none" xmlns="http://www.w3.org/2000/svg" class="hidden h-[1.2rem] w-[1.2rem] text-neutral-800 dark:block dark:text-neutral-200"><path d="M2.89998 0.499976C2.89998 0.279062 2.72089 0.0999756 2.49998 0.0999756C2.27906 0.0999756 2.09998 0.279062 2.09998 0.499976V1.09998H1.49998C1.27906 1.09998 1.09998 1.27906 1.09998 1.49998C1.09998 1.72089 1.27906 1.89998 1.49998 1.89998H2.09998V2.49998C2.09998 2.72089 2.27906 2.89998 2.49998 2.89998C2.72089 2.89998 2.89998 2.72089 2.89998 2.49998V1.89998H3.49998C3.72089 1.89998 3.89998 1.72089 3.89998 1.49998C3.89998 1.27906 3.72089 1.09998 3.49998 1.09998H2.89998V0.499976ZM5.89998 3.49998C5.89998 3.27906 5.72089 3.09998 5.49998 3.09998C5.27906 3.09998 5.09998 3.27906 5.09998 3.49998V4.09998H4.49998C4.27906 4.09998 4.09998 4.27906 4.09998 4.49998C4.09998 4.72089 4.27906 4.89998 4.49998 4.89998H5.09998V5.49998C5.09998 5.72089 5.27906 5.89998 5.49998 5.89998C5.72089 5.89998 5.89998 5.72089 5.89998 5.49998V4.89998H6.49998C6.72089 4.89998 6.89998 4.72089 6.89998 4.49998C6.89998 4.27906 6.72089 4.09998 6.49998 4.09998H5.89998V3.49998ZM1.89998 6.49998C1.89998 6.27906 1.72089 6.09998 1.49998 6.09998C1.27906 6.09998 1.09998 6.27906 1.09998 6.49998V7.09998H0.499976C0.279062 7.09998 0.0999756 7.27906 0.0999756 7.49998C0.0999756 7.72089 0.279062 7.89998 0.499976 7.89998H1.09998V8.49998C1.09998 8.72089 1.27906 8.89997 1.49998 8.89997C1.72089 8.89997 1.89998 8.72089 1.89998 8.49998V7.89998H2.49998C2.72089 7.89998 2.89998 7.72089 2.89998 7.49998C2.89998 7.27906 2.72089 7.09998 2.49998 7.09998H1.89998V6.49998ZM8.54406 0.98184L8.24618 0.941586C8.03275 0.917676 7.90692 1.1655 8.02936 1.34194C8.17013 1.54479 8.29981 1.75592 8.41754 1.97445C8.91878 2.90485 9.20322 3.96932 9.20322 5.10022C9.20322 8.37201 6.82247 11.0878 3.69887 11.6097C3.45736 11.65 3.20988 11.6772 2.96008 11.6906C2.74563 11.702 2.62729 11.9535 2.77721 12.1072C2.84551 12.1773 2.91535 12.2458 2.98667 12.3128L3.05883 12.3795L3.31883 12.6045L3.50684 12.7532L3.62796 12.8433L3.81491 12.9742L3.99079 13.089C4.11175 13.1651 4.23536 13.2375 4.36157 13.3059L4.62496 13.4412L4.88553 13.5607L5.18837 13.6828L5.43169 13.7686C5.56564 13.8128 5.70149 13.8529 5.83857 13.8885C5.94262 13.9155 6.04767 13.9401 6.15405 13.9622C6.27993 13.9883 6.40713 14.0109 6.53544 14.0298L6.85241 14.0685L7.11934 14.0892C7.24637 14.0965 7.37436 14.1002 7.50322 14.1002C11.1483 14.1002 14.1032 11.1453 14.1032 7.50023C14.1032 7.25044 14.0893 7.00389 14.0623 6.76131L14.0255 6.48407C13.991 6.26083 13.9453 6.04129 13.8891 5.82642C13.8213 5.56709 13.7382 5.31398 13.6409 5.06881L13.5279 4.80132L13.4507 4.63542L13.3766 4.48666C13.2178 4.17773 13.0353 3.88295 12.8312 3.60423L12.6782 3.40352L12.4793 3.16432L12.3157 2.98361L12.1961 2.85951L12.0355 2.70246L11.8134 2.50184L11.4925 2.24191L11.2483 2.06498L10.9562 1.87446L10.6346 1.68894L10.3073 1.52378L10.1938 1.47176L9.95488 1.3706L9.67791 1.2669L9.42566 1.1846L9.10075 1.09489L8.83599 1.03486L8.54406 0.98184ZM10.4032 5.30023C10.4032 4.27588 10.2002 3.29829 9.83244 2.40604C11.7623 3.28995 13.1032 5.23862 13.1032 7.50023C13.1032 10.593 10.596 13.1002 7.50322 13.1002C6.63646 13.1002 5.81597 12.9036 5.08355 12.5522C6.5419 12.0941 7.81081 11.2082 8.74322 10.0416C8.87963 10.2284 9.10028 10.3497 9.34928 10.3497C9.76349 10.3497 10.0993 10.0139 10.0993 9.59971C10.0993 9.24256 9.84965 8.94373 9.51535 8.86816C9.57741 8.75165 9.63653 8.63334 9.6926 8.51332C9.88358 8.63163 10.1088 8.69993 10.35 8.69993C11.0403 8.69993 11.6 8.14028 11.6 7.44993C11.6 6.75976 11.0406 6.20024 10.3505 6.19993C10.3853 5.90487 10.4032 5.60464 10.4032 5.30023Z" fill="currentColor" fill-rule="evenodd" clip-rule="evenodd"></path></svg></button></div></div></div><script>
              // Load Klaviyo script
              (function() {
                var s = document.createElement('script');
                s.type = 'text/javascript';
                s.async = true;
                s.src = 'https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=Yxt67z';
                s.onload = function() {
                  // Set up event listeners after Klaviyo script is loaded
                  setupKlaviyoFormTriggers();
                };
                var h = document.getElementsByTagName('script')[0];
                h.parentNode.insertBefore(s, h);
              })();

              // Function to set up Klaviyo form triggers
              function setupKlaviyoFormTriggers() {
                document.addEventListener('DOMContentLoaded', function() {
                  // French form trigger
                  var frenchTrigger = document.querySelector('.klaviyo_form_trigger_fr');
                  if (frenchTrigger) {
                    frenchTrigger.addEventListener('click', function(e) {
                      e.preventDefault();
                      window._klOnsite = window._klOnsite || [];
                      window._klOnsite.push(['openForm', 'VdDBGB']);
                    });
                  }
                });

                // Also set up event listeners immediately in case DOM is already loaded
                if (document.readyState === 'complete' || document.readyState === 'interactive') {
                  // French form trigger
                  var frenchTrigger = document.querySelector('.klaviyo_form_trigger_fr');
                  if (frenchTrigger) {
                    frenchTrigger.addEventListener('click', function(e) {
                      e.preventDefault();
                      window._klOnsite = window._klOnsite || [];
                      window._klOnsite.push(['openForm', 'VdDBGB']);
                    });
                  }
                }
              }
            </script><script src="https://david-yao.com/_next/static/chunks/webpack-c97c4cd6be511ece.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"https://david-yao.com/_next/static/media/a34f9d1faa5f3315-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"https://david-yao.com/_next/static/css/5a598a53a1b8c772.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"3:I[5751,[],\"\"]\n6:I[9275,[],\"\"]\n8:I[1343,[],\"\"]\n9:I[4858,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"ThemeProvider\"]\na:I[9736,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"TooltipProvider\"]\nb:I[6691,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"Dock\"]\nc:I[6691,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"DockIcon\"]\nd:I[9736,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"Tooltip\"]\ne:I[9736,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"TooltipTrigger\"]\nf:I[231,[\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"173\",\"static/chunks/173-06ea4b2e1871cc35.js\",\"308\",\"static/chunks"])</script><script>self.__next_f.push([1,"/app/blog/%5Bslug%5D/page-180ef92bcd4a6ad4.js\"],\"\"]\n10:I[9736,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"TooltipContent\"]\n11:I[9973,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"Separator\"]\n13:I[7363,[\"310\",\"static/chunks/0e5ce63c-e21fe8bbb1ba0e0f.js\",\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"633\",\"static/chunks/633-2667c71f837e2c91.js\",\"685\",\"static/chunks/685-38d3d3a09bf3d7e5.js\",\"392\",\"static/chunks/392-a90341f24030e785.js\",\"185\",\"static/chunks/app/layout-a6b5bc5d75b10efa.js\"],\"ModeToggle\"]\n16:I[6130,[],\"\"]\n7:[\"slug\",\"devto-1656027\",\"d\"]\n12:T843,"])</script><script>self.__next_f.push([1,"M409.132 114.573c-19.608-33.596-46.205-60.194-79.798-79.8-33.598-19.607-70.277-29.408-110.063-29.408-39.781 0-76.472 9.804-110.063 29.408-33.596 19.605-60.192 46.204-79.8 79.8C9.803 148.168 0 184.854 0 224.63c0 47.78 13.94 90.745 41.827 128.906 27.884 38.164 63.906 64.572 108.063 79.227 5.14.954 8.945.283 11.419-1.996 2.475-2.282 3.711-5.14 3.711-8.562 0-.571-.049-5.708-.144-15.417a2549.81 2549.81 0 01-.144-25.406l-6.567 1.136c-4.187.767-9.469 1.092-15.846 1-6.374-.089-12.991-.757-19.842-1.999-6.854-1.231-13.229-4.086-19.13-8.559-5.898-4.473-10.085-10.328-12.56-17.556l-2.855-6.57c-1.903-4.374-4.899-9.233-8.992-14.559-4.093-5.331-8.232-8.945-12.419-10.848l-1.999-1.431c-1.332-.951-2.568-2.098-3.711-3.429-1.142-1.331-1.997-2.663-2.568-3.997-.572-1.335-.098-2.43 1.427-3.289 1.525-.859 4.281-1.276 8.28-1.276l5.708.853c3.807.763 8.516 3.042 14.133 6.851 5.614 3.806 10.229 8.754 13.846 14.842 4.38 7.806 9.657 13.754 15.846 17.847 6.184 4.093 12.419 6.136 18.699 6.136 6.28 0 11.704-.476 16.274-1.423 4.565-.952 8.848-2.383 12.847-4.285 1.713-12.758 6.377-22.559 13.988-29.41-10.848-1.14-20.601-2.857-29.264-5.14-8.658-2.286-17.605-5.996-26.835-11.14-9.235-5.137-16.896-11.516-22.985-19.126-6.09-7.614-11.088-17.61-14.987-29.979-3.901-12.374-5.852-26.648-5.852-42.826 0-23.035 7.52-42.637 22.557-58.817-7.044-17.318-6.379-36.732 1.997-58.24 5.52-1.715 13.706-.428 24.554 3.853 10.85 4.283 18.794 7.952 23.84 10.994 5.046 3.041 9.089 5.618 12.135 7.708 17.705-4.947 35.976-7.421 54.818-7.421s37.117 2.474 54.823 7.421l10.849-6.849c7.419-4.57 16.18-8.758 26.262-12.565 10.088-3.805 17.802-4.853 23.134-3.138 8.562 21.509 9.325 40.922 2.279 58.24 15.036 16.18 22.559 35.787 22.559 58.817 0 16.178-1.958 30.497-5.853 42.966-3.9 12.471-8.941 22.457-15.125 29.979-6.191 7.521-13.901 13.85-23.131 18.986-9.232 5.14-18.182 8.85-26.84 11.136-8.662 2.286-18.415 4.004-29.263 5.146 9.894 8.562 14.842 22.077 14.842 40.539v60.237c0 3.422 1.19 6.279 3.572 8.562 2.379 2.279 6.136 2.95 11.276 1.995 44.163-14.653 80.185-41.062 108.068-79.226 27.88-38.161 41.825-81.126 41.825-128.906-.01-39.771-9.818-76.454-29.414-110.049z"])</script><script>self.__next_f.push([1,"14:T7bb,\n              // Load Klaviyo script\n              (function() {\n                var s = document.createElement('script');\n                s.type = 'text/javascript';\n                s.async = true;\n                s.src = 'https://static.klaviyo.com/onsite/js/klaviyo.js?company_id=Yxt67z';\n                s.onload = function() {\n                  // Set up event listeners after Klaviyo script is loaded\n                  setupKlaviyoFormTriggers();\n                };\n                var h = document.getElementsByTagName('script')[0];\n                h.parentNode.insertBefore(s, h);\n              })();\n\n              // Function to set up Klaviyo form triggers\n              function setupKlaviyoFormTriggers() {\n                document.addEventListener('DOMContentLoaded', function() {\n                  // French form trigger\n                  var frenchTrigger = document.querySelector('.klaviyo_form_trigger_fr');\n                  if (frenchTrigger) {\n                    frenchTrigger.addEventListener('click', function(e) {\n                      e.preventDefault();\n                      window._klOnsite = window._klOnsite || [];\n                      window._klOnsite.push(['openForm', 'VdDBGB']);\n                    });\n                  }\n                });\n\n                // Also set up event listeners immediately in case DOM is already loaded\n                if (document.readyState === 'complete' || document.readyState === 'interactive') {\n                  // French form trigger\n                  var frenchTrigger = document.querySelector('.klaviyo_form_trigger_fr');\n                  if (frenchTrigger) {\n                    frenchTrigger.addEventListener('click', function(e) {\n                      e.preventDefault();\n                      window._klOnsite = window._klOnsite || [];\n                      window._klOnsite.push(['openForm', 'VdDBGB']);\n                    });\n                  }\n                }\n              }\n            17:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"https://david-yao.com/_next/static/css/5a598a53a1b8c772.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"x-bW-EDpU3dvEHDggD25p\",\"assetPrefix\":\"https://david-yao.com\",\"initialCanonicalUrl\":\"/blog/devto-1656027\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"devto-1656027\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"devto-1656027\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"devto-1656027\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L4\",\"$L5\"],null],null]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$7\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"min-h-screen bg-background font-sans antialiased max-w-2xl mx-auto py-12 sm:py-24 px-6 __variable_18454d\",\"children\":[[\"$\",\"$L9\",null,{\"attribute\":\"class\",\"defaultTheme\":\"light\",\"children\":[\"$\",\"$La\",null,{\"delayDuration\":0,\"children\":[[\"$\",\"$L6\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"div\",null,{\"className\":\"pointer-events-none fixed inset-x-0 bottom-0 z-30 mx-auto mb-4 flex origin-bottom h-full max-h-14\",\"children\":[[\"$\",\"div\",null,{\"className\":\"fixed bottom-0 inset-x-0 h-16 w-full bg-background to-transparent backdrop-blur-lg [-webkit-mask-image:linear-gradient(to_top,black,transparent)] dark:bg-background\"}],[\"$\",\"$Lb\",null,{\"className\":\"z-50 pointer-events-auto relative mx-auto flex min-h-full h-full items-center px-1 bg-background [box-shadow:0_0_0_1px_rgba(0,0,0,.03),0_2px_4px_rgba(0,0,0,.05),0_12px_24px_rgba(0,0,0,.05)] transform-gpu dark:[border:1px_solid_rgba(255,255,255,.1)] dark:[box-shadow:0_-20px_80px_-20px_#ffffff1f_inset] \",\"children\":[[[\"$\",\"$Lc\",\"/\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-home size-4\",\"children\":[[\"$\",\"path\",\"y5dka4\",{\"d\":\"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z\"}],[\"$\",\"polyline\",\"e2us08\",{\"points\":\"9 22 9 12 15 12 15 22\"}],\"$undefined\"]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Home\"}]}]]}]}],[\"$\",\"$Lc\",\"/blog\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/blog\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-notebook size-4\",\"children\":[[\"$\",\"path\",\"aawbzj\",{\"d\":\"M2 6h4\"}],[\"$\",\"path\",\"l0bgd4\",{\"d\":\"M2 10h4\"}],[\"$\",\"path\",\"1gsvsf\",{\"d\":\"M2 14h4\"}],[\"$\",\"path\",\"1bu2t1\",{\"d\":\"M2 18h4\"}],[\"$\",\"rect\",\"1nb95v\",{\"width\":\"16\",\"height\":\"20\",\"x\":\"4\",\"y\":\"2\",\"rx\":\"2\"}],[\"$\",\"path\",\"rotuqe\",{\"d\":\"M16 2v20\"}],\"$undefined\"]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Blog\"}]}]]}]}],[\"$\",\"$Lc\",\"/ebook\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"/ebook\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-book size-4\",\"children\":[[\"$\",\"path\",\"t4utmx\",{\"d\":\"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20\"}],\"$undefined\"]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Free Ebook\"}]}]]}]}]],[\"$\",\"$L11\",null,{\"orientation\":\"vertical\",\"className\":\"h-full\"}],[[\"$\",\"$Lc\",\"GitHub\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"https://github.com/daviidy\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"viewBox\":\"0 0 438.549 438.549\",\"className\":\"size-4\",\"children\":[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"$12\"}]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"GitHub\"}]}]]}]}],[\"$\",\"$Lc\",\"LinkedIn\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"https://www.linkedin.com/in/nda-yao/\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"viewBox\":\"0 0 24 24\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"size-4\",\"children\":[[\"$\",\"title\",null,{\"children\":\"LinkedIn\"}],[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z\"}]]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"LinkedIn\"}]}]]}]}],[\"$\",\"$Lc\",\"X\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"https://x.com/davidyao_dev\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"viewBox\":\"0 0 24 24\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"size-4\",\"children\":[[\"$\",\"title\",null,{\"children\":\"X\"}],[\"$\",\"path\",null,{\"fill\":\"currentColor\",\"d\":\"M18.901 1.153h3.68l-8.04 9.19L24 22.846h-7.406l-5.8-7.584-6.638 7.584H.474l8.6-9.83L0 1.154h7.594l5.243 6.932ZM17.61 20.644h2.039L6.486 3.24H4.298Z\"}]]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"X\"}]}]]}]}],[\"$\",\"$Lc\",\"Youtube\",{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$Lf\",null,{\"href\":\"https://www.youtube.com/@davidyao_dev\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-full size-12\",\"children\":[\"$\",\"svg\",null,{\"width\":\"32px\",\"height\":\"32px\",\"viewBox\":\"0 0 32 32\",\"fill\":\"currentColor\",\"xmlns\":\"http://www.w3.org/2000/svg\",\"className\":\"size-4\",\"children\":[[\"$\",\"title\",null,{\"children\":\"youtube\"}],[\"$\",\"path\",null,{\"d\":\"M29.41,9.26a3.5,3.5,0,0,0-2.47-2.47C24.76,6.2,16,6.2,16,6.2s-8.76,0-10.94.59A3.5,3.5,0,0,0,2.59,9.26,36.13,36.13,0,0,0,2,16a36.13,36.13,0,0,0,.59,6.74,3.5,3.5,0,0,0,2.47,2.47C7.24,25.8,16,25.8,16,25.8s8.76,0,10.94-.59a3.5,3.5,0,0,0,2.47-2.47A36.13,36.13,0,0,0,30,16,36.13,36.13,0,0,0,29.41,9.26ZM13.2,20.2V11.8L20.47,16Z\"}]]}]}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Youtube\"}]}]]}]}]],[\"$\",\"$L11\",null,{\"orientation\":\"vertical\",\"className\":\"h-full py-2\"}],[\"$\",\"$Lc\",null,{\"children\":[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"asChild\":true,\"children\":[\"$\",\"$L13\",null,{}]}],[\"$\",\"$L10\",null,{\"children\":[\"$\",\"p\",null,{\"children\":\"Theme\"}]}]]}]}]]}]]}]]}]}],[\"$\",\"script\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$14\"}}]]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$L15\"],\"globalErrorComponent\":\"$16\",\"missingSlots\":\"$W17\"}]]\n"])</script><script>self.__next_f.push([1,"15:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"How to implement Token-Based Authentication and Authorization in Rails | Nda David Yao\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"\\\"Technologies change, but the basics are the same\\\". That's what my mentor told me years ago when I...\"}],[\"$\",\"meta\",\"4\",{\"name\":\"robots\",\"content\":\"index, follow\"}],[\"$\",\"meta\",\"5\",{\"name\":\"googlebot\",\"content\":\"index, follow, max-video-preview:-1, max-image-preview:large, max-snippet:-1\"}],[\"$\",\"meta\",\"6\",{\"property\":\"og:title\",\"content\":\"How to implement Token-Based Authentication and Authorization in Rails\"}],[\"$\",\"meta\",\"7\",{\"property\":\"og:description\",\"content\":\"\\\"Technologies change, but the basics are the same\\\". That's what my mentor told me years ago when I...\"}],[\"$\",\"meta\",\"8\",{\"property\":\"og:url\",\"content\":\"https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj\"}],[\"$\",\"meta\",\"9\",{\"property\":\"og:image\",\"content\":\"https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png\"}],[\"$\",\"meta\",\"10\",{\"property\":\"og:type\",\"content\":\"article\"}],[\"$\",\"meta\",\"11\",{\"property\":\"article:published_time\",\"content\":\"2023-11-30T06:16:47Z\"}],[\"$\",\"meta\",\"12\",{\"name\":\"twitter:card\",\"content\":\"summary_large_image\"}],[\"$\",\"meta\",\"13\",{\"name\":\"twitter:title\",\"content\":\"How to implement Token-Based Authentication and Authorization in Rails\"}],[\"$\",\"meta\",\"14\",{\"name\":\"twitter:description\",\"content\":\"\\\"Technologies change, but the basics are the same\\\". That's what my mentor told me years ago when I...\"}],[\"$\",\"meta\",\"15\",{\"name\":\"twitter:image\",\"content\":\"https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png\"}],[\"$\",\"link\",\"16\",{\"rel\":\"shortcut icon\",\"href\":\"/dave.png\"}],[\"$\",\"link\",\"17\",{\"rel\":\"icon\",\"href\":\"/dave.png\"}],[\"$\",\"link\",\"18\",{\"rel\":\"apple-touch-icon\",\"href\":\"/dave.png\"}],[\"$\",\"meta\",\"19\",{\"name\":\"next-size-adjust\"}]]\n"])</script><script>self.__next_f.push([1,"4:null\n"])</script><script>self.__next_f.push([1,"18:\"$Sreact.suspense\"\n1a:I[8173,[\"231\",\"static/chunks/231-2d095471957ff3d5.js\",\"173\",\"static/chunks/173-06ea4b2e1871cc35.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-180ef92bcd4a6ad4.js\"],\"Image\"]\n19:T13b99,"])</script><script>self.__next_f.push([1,"\u003cp\u003e\"Technologies change, but the basics are the same\". That's what my mentor told me years ago when I asked him how I could be a great software engineer. And it's so true especially when it comes to securing an API with a token-based authentication. No matter the framework you use (Spring, Rails, Laravel, etc.), the principle is the same. So in this blog post, we will discuss how to implement it successfully in your Rails application.\u003c/p\u003e\n\u003ch2\u003eThe project:\u003c/h2\u003e\n\u003cp\u003eWe want to create a backend API for an app like \u003ca href=\"https://www.hackerrank.com/\"\u003eHackerrank\u003c/a\u003e.\nHere is the Database Design and Entity-Relationship Diagram (ERD) for the API.\u003c/p\u003e\n\u003cp\u003eFor the entities, we have:\n- Users\n- Challenges (Programming questions)\n- Submissions (User solutions to challenges)\n- Categories (Challenge categories)\n- Comments (User comments on challenges)\n- Ratings (User ratings for challenges)\n- Test Cases (Input and expected output for challenges)\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://dev-to-uploads.s3.amazonaws.com/uploads/articles/s00w7deqg0n3pgyia5vv.png\" alt=\"Image description\"\u003e\u003c/p\u003e\n\u003cp\u003eHere are some relationships from the diagram above:\n- A User has many Submissions.\n- A Challenge belongs to a Category.\n- A Challenge has many Test Cases.\n- Only admins can create, update, or delete challenges, submissions, categories, or test cases.\u003c/p\u003e\n\u003cp\u003eNow, let's focus on implementing the authentication and authorization for our API. I assume you already know how to install a rails application focused on an API implementation, how to generate controllers and models.\nWe will go with the basic MVC architecture provided by Rails.\u003c/p\u003e\n\u003ch2\u003eInstall the necessary gems\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAdd this to your \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eGemfile\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003egem \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'bcrypt'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e # For hashing passwords\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003egem \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'jwt'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e   # For JWT authentication\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003e\u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003ebcrypt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e will be used for password-hashing.\n\u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003ejwt\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e will be used to successfully log the user in and handle authorization.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCreate a \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003esecret_key_generator\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e file in your \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003einitializers\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e folder and paste this:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# config/initializers/secret_key_generator.rb\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# Require the SecureRandom module\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003erequire\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'securerandom'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# Generate a random secret key\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003esecret_key \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e SecureRandom\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.hex(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e32\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# Adjust the size as needed (e.g., 64 characters for a 256-bit key)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# Set the secret key as an environment variable\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eENV\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'APP_SECRET_KEY'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e] \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e secret_key\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eInitializers are executed when the Rails application boots. In our case, this initializer generates a random secret key using SecureRandom and sets it as an environment variable (APP_SECRET_KEY). We will use it to decode JWT tokens.\u003c/p\u003e\n\u003ch2\u003eCreate the models and migration files\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eUser\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e User\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationRecord\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  enum \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003erole:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003edefault:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e 0\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eadmin:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:name\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  validates_uniqueness_of \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:password\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003elength:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eminimum:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e 6\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  has_secure_password\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e admin?\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    role \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e==\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'admin'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e CreateUsers\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ActiveRecord::Migration\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e7.1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e change\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    create_table \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:users\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e do\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e |t|\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.string \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:name\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.string \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.string \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:password_digest\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.integer \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:role\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.timestamps\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cul\u003e\n\u003cli\u003eCategory\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e Category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationRecord\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eallow_blank:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    has_many \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenge_categories\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    has_many \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenges\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ethrough:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :challenge_categories\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e CreateCategories\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ActiveRecord::Migration\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e7.1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e change\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    create_table \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:categories\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e do\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e |t|\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.string \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.text \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:null\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e =\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.timestamps\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cul\u003e\n\u003cli\u003eChallenge\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e Challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationRecord\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    validates \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003epresence:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    has_many \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenge_categories\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    has_many \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:categories\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ethrough:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :challenge_categories\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e CreateChallenges\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ActiveRecord::Migration\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e7.1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e change\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    create_table \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenges\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e do\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e |t|\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.string \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.text \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.timestamps\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eAnd since there is a many-to-many relationship between Challenge and Category, let's add the pivot table:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e CreateChallengeCategories\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ActiveRecord::Migration\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e7.1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e change\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    create_table \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenge_categories\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e do\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e |t|\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.references \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003enull:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e false\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eforeign_key:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.references \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003enull:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e false\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eforeign_key:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      t.timestamps\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003ch2\u003eAdd the routes\u003c/h2\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003eresources \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:users\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eonly:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:create\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  namespace \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:auth\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e do\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    post \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'/login'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eto:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'sessions#create'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    delete \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'/logout'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eto:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'sessions#destroy'\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  resources \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenges\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  post \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'/admin'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eto:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'users#add_admin'\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eYou may have guessed it, but you will need to create a \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003econtrollers/auth\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e folder. I'll explain why in a few minutes.\u003c/p\u003e\n\u003ch2\u003eAuthentication logic\u003c/h2\u003e\n\u003cul\u003e\n\u003cli\u003eAdd this to your \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eusers_controller\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e file:\u003c/li\u003e\n\u003c/ul\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e UsersController\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationController\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e create\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e User\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003enew\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e(user_params)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @user.save\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Registration successful. Please log in.'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :created\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerrors:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @user.errors.full_messages }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e add_admin\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    email \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e params[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e email.blank?\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerrors:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Email parameter is required'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e User\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.find_by(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eemail:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e email)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @user.nil?\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerrors:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'No user with that Email found'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :not_found\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      @user.update_column(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:role\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e1\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'User is now an admin'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :ok\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  private\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e user_params\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      params.require(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:user\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e).permit(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:name\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:password\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:password_confirmation\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eThat controller is simply responsible for creating new users and admins.\u003c/p\u003e\n\u003cp\u003eCreate a \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003ehelpers/token_helper\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e file in your \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eapp\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e folder and add this code:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# app/helpers/token_helper.rb\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003emodule\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e TokenHelper\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e decode_token\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e(token)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e    JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.decode(token, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eENV\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'APP_SECRET_KEY'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e], \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003etrue\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ealgorithm:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'HS256'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  rescue\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e::\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eDecodeError\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e    nil\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eAnd include it in your \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eapplication_controller\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003einclude\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e TokenHelper\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eNow let's create a \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003esessions_controller\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e in our \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eauth\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e folder and add this code:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# app/controllers/sessions_controller.rb\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e Auth::SessionsController\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationController\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e create\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e User\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.find_by(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eemail:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e params[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:email\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e\u0026#x26;\u0026#x26;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e user.authenticate(params[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:password\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # Set the expiration time (e.g., 1 hour from now)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        expiration_time \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Time\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.now.to_i \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e+\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e3600\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e *\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e 3\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# 3600 seconds = 1 hour\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # Create the payload\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        payload \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e            user_id:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e user.id,\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e            exp:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e expiration_time \u003c/span\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e# This sets the expiration time\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        token \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.encode(payload, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eENV\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'APP_SECRET_KEY'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e], \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'HS256'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Logged in successfully'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003etoken:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e token }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerror:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Invalid credentials'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unauthorized\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e destroy\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e    # Invalidate the JWT token by marking it as expired or revoking it.\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    token \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e extract_token_from_request\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e token\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e      begin\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # Try to decode the token to check its validity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        payload, _ \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.decode(token, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eENV\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'APP_SECRET_KEY'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e], \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003etrue\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ealgorithm:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'HS256'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # At this point, the token is considered valid\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # Add expiration to the payload to mark the token as invalid\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        payload[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'exp'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e] \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Time\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.now.to_i\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        new_token \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.encode(payload, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eENV\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'APP_SECRET_KEY'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e], \u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'HS256'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Logged out successfully'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e      rescue\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e JWT\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e::\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eDecodeError\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"\u003e        # JWT::DecodeError is raised when the token is not valid\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'You need to sign in or sign up before continuing'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unauthorized\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e      end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'No token found'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  private\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e extract_token_from_request\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    request.headers[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'Authorization'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u0026#x26;.split\u0026#x26;.last\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eWhat we did there basically is generate a new token when a user logs in and invalidate a token when a user logs out. Remember, the token is used to check if a user session is valid or not. If you don't know how JWT tokens work, check the documentation \u003ca href=\"https://en.wikipedia.org/wiki/JSON_Web_Token\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eNow if you request \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003ePOST /users\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e and \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003ePOST /login\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e with the correct parameters using Postman, it should work.\u003c/p\u003e\n\u003ch2\u003eAdd the Challenge and Category controllers:\u003c/h2\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ChallengesController\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationController\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:set_challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eonly:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:update\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:destroy\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:authorize_user\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eexcept:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:index\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:authorize_admin\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eexcept:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:index\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e index\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        @challenges \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.all\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenges\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e show\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e create\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        @challenge \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003enew\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e(challenge_params)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge.save\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :created\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge.errors, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e update\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge.update(challenge_params)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @challenge.errors, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e destroy\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        @challenge.destroy\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003emessage:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Challenge was successfully deleted'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    private\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e set_challenge\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        @challenge \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.find(params[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:id\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e challenge_params\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        params.require(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:challenge\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e).permit(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ecategory_ids:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eclass\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e CategoriesController\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e ApplicationController\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:set_category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eonly:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:update\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:destroy\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:authorize_user\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eexcept:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:index\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e  before_action \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:authorize_admin\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eexcept:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:index\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:show\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e index\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @categories \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.all\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @categories\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e show\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e create\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @category \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003enew\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e(category_params)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category.save\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :created\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category.errors, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e update\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category.update(category_params)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e      render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e @category.errors, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unprocessable_entity\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e destroy\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @category.destroy\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    head \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:no_content\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  private\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e set_category\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    @category \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e Category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.find(params[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:id\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e category_params\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e    params.require(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:category\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e).permit(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:title\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e:description\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003echallenge_ids:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e [])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e  end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003eend\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eAs you can see, both controllers check if the user session is valid before executing some controller actions (create, update, delete). They are doing so with authorize_user and authorize_admin.\nAdd those methods in your application_controller:\u003c/p\u003e\n\u003cfigure data-rehype-pretty-code-figure=\"\"\u003e\u003cpre style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\" tabindex=\"0\" data-language=\"ruby\" data-theme=\"github-dark github-light\"\u003e\u003ccode data-language=\"ruby\" data-theme=\"github-dark github-light\" style=\"display: grid;\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003edef\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e authorize_user\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        token \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e request.headers[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'Authorization'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e]\u0026#x26;.split(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e' '\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e)\u0026#x26;.last\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e        payload \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e decode_token(token)\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e payload.nil?\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerror:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Unauthorized'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unauthorized\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        else\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            @current_user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e User\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e.find(payload[\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e'user_id'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e])\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e \u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    def\u003c/span\u003e\u003cspan style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"\u003e authorize_admin\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e !\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e@current_user \u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e||\u003c/span\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e !\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e@current_user.admin?\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e            render \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003ejson:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e { \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003eerror:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"\u003e 'Unauthorized'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"\u003e }, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003estatus:\u003c/span\u003e\u003cspan style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"\u003e :unauthorized\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e        end\u003c/span\u003e\u003c/span\u003e\n\u003cspan data-line=\"\"\u003e\u003cspan style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"\u003e    end\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/figure\u003e\n\u003cp\u003eNow, try to create a challenge without logging in and you should get an \u003cspan data-rehype-pretty-code-figure=\"\"\u003e\u003ccode data-language=\"plaintext\" data-theme=\"github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg:#24292e;--shiki-light-bg:#fff\"\u003e\u003cspan data-line=\"\"\u003e\u003cspan\u003eUnauthorized\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/span\u003e message. Log in, set the current user as admin, try again and it should work.\u003c/p\u003e\n\u003cp\u003eEt voila, let me know in the comments section if you found this article helpful.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"5:[\"$\",\"section\",null,{\"id\":\"blog\",\"children\":[[\"$\",\"script\",null,{\"type\":\"application/ld+json\",\"suppressHydrationWarning\":true,\"dangerouslySetInnerHTML\":{\"__html\":\"{\\\"@context\\\":\\\"https://schema.org\\\",\\\"@type\\\":\\\"BlogPosting\\\",\\\"headline\\\":\\\"How to implement Token-Based Authentication and Authorization in Rails\\\",\\\"datePublished\\\":\\\"2023-11-30T06:16:47Z\\\",\\\"dateModified\\\":\\\"2023-11-30T06:16:47Z\\\",\\\"description\\\":\\\"\\\\\\\"Technologies change, but the basics are the same\\\\\\\". That's what my mentor told me years ago when I...\\\",\\\"image\\\":\\\"https://media2.dev.to/dynamic/image/width=1000,height=420,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Farticles%2Fqh6jn4lt6p7at870n9wv.png\\\",\\\"url\\\":\\\"https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj\\\",\\\"author\\\":{\\\"@type\\\":\\\"Person\\\",\\\"name\\\":\\\"Nda David Yao\\\"}}\"}}],[\"$\",\"h1\",null,{\"className\":\"title font-medium text-2xl tracking-tighter max-w-[650px]\",\"children\":\"How to implement Token-Based Authentication and Authorization in Rails\"}],[\"$\",\"div\",null,{\"className\":\"flex justify-between items-center mt-2 mb-8 text-sm max-w-[650px]\",\"children\":[[\"$\",\"$18\",null,{\"fallback\":[\"$\",\"p\",null,{\"className\":\"h-5\"}],\"children\":[\"$\",\"p\",null,{\"className\":\"text-sm text-neutral-600 dark:text-neutral-400\",\"children\":\"November 30, 2023 (1y ago)\"}]}],[\"$\",\"$Lf\",null,{\"href\":\"https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"className\":\"text-sm text-neutral-600 dark:text-neutral-400 hover:text-neutral-800 dark:hover:text-neutral-200\",\"children\":\"Read on Dev.to â†’\"}]]}],[\"$\",\"article\",null,{\"className\":\"prose dark:prose-invert max-w-none prose-pre:bg-neutral-100 dark:prose-pre:bg-neutral-900 prose-pre:border prose-pre:border-neutral-200 dark:prose-pre:border-neutral-800 prose-pre:rounded-lg prose-code:before:content-none prose-code:after:content-none prose-code:font-normal prose-code:bg-neutral-100 dark:prose-code:bg-neutral-900 prose-code:rounded prose-code:px-1 prose-code:py-0.5 prose-code:text-neutral-800 dark:prose-code:text-neutral-200 prose-a:text-blue-500 hover:prose-a:text-blue-400 prose-headings:font-medium prose-h2:text-xl prose-h2:tracking-tight prose-p:leading-7 prose-li:leading-7\",\"dangerouslySetInnerHTML\":{\"__html\":\"$19\"}}],[\"$\",\"div\",null,{\"className\":\"mt-16\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center justify-between mb-8\",\"children\":[[\"$\",\"h2\",null,{\"className\":\"text-xl font-medium tracking-tighter\",\"children\":[\"Comments (\",3,\")\"]}],[\"$\",\"$Lf\",null,{\"href\":\"https://dev.to/daviidy/how-to-implement-authentication-and-authorization-api-in-rails-51nj#comments\",\"target\":\"_blank\",\"rel\":\"noopener noreferrer\",\"children\":\"Add Comment\",\"className\":\"inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2\"}]]}],[\"$\",\"div\",null,{\"className\":\"space-y-8\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex gap-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex-shrink-0\",\"children\":[\"$\",\"$L1a\",null,{\"src\":\"https://media2.dev.to/dynamic/image/width=640,height=640,fit=cover,gravity=auto,format=auto/https%3A%2F%2Fdev-to-uploads.s3.amazonaws.com%2Fuploads%2Fuser%2Fprofile_image%2F1120282%2F9ecbab3b-8cda-4acd-92fc-bf4eb86d4bbc.jpeg\",\"alt\":\"CedricLapi\",\"width\":40,\"height\":40,\"className\":\"rounded-full\"}]}],[\"$\",\"div\",null,{\"className\":\"flex-1\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex items-center gap-2 mb-2\",\"children\":[[\"$\",\"span\",null,{\"className\":\"font-medium\",\"children\":\"CedricLapi\"}],[\"$\",\"span\",null,{\"className\":\"text-sm text-neutral-600 dark:text-neutral-400\",\"children\":[\"@\",\"cedriclapi\"]}],[\"$\",\"span\",null,{\"className\":\"text-sm text-neutral-600 dark:text-neutral-400\",\"children\":[\"â€¢ \",\"November 30, 2023 (1y ago)\"]}]]}],[\"$\",\"div\",null,{\"className\":\"prose dark:prose-invert\",\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cp\u003eNice article, quite interesting!\u003c/p\u003e\\n\\n\"}}],false]}]]}]]}]]}]]}]\n"])</script></body></html>